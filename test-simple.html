<!DOCTYPE html>
<html>
<head>
    <title>Simple Contract Test</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
</head>
<body>
    <h1>Testing Somnia Contract Connection</h1>
    <div id="output"></div>
    
    <script>
        async function testContract() {
            const output = document.getElementById('output');
            
            try {
                output.innerHTML += '<p>🔄 Starting test...</p>';
                
                // Use ethers v5 syntax
                const provider = new ethers.providers.JsonRpcProvider('https://dream-rpc.somnia.network');
                output.innerHTML += '<p>✅ Provider created</p>';
                
                // Test network
                const network = await provider.getNetwork();
                output.innerHTML += `<p>🌐 Network: ${network.chainId}</p>`;
                
                // Test contract
                const contractAddress = '0xf88B9e01A9B350E05cD8971DdDF7fC2c73910352';
                const abi = [
                    "function totalPosts() view returns (uint256)",
                    "function getPost(uint256 id) view returns (tuple(uint256 id, address author, string content, bool flagged))"
                ];
                
                const contract = new ethers.Contract(contractAddress, abi, provider);
                output.innerHTML += '<p>📄 Contract created</p>';
                
                const total = await contract.totalPosts();
                output.innerHTML += `<p>📊 Total posts: ${total.toString()}</p>`;
                
                if (total.gt(0)) {
                    const post = await contract.getPost(1);
                    output.innerHTML += `<p>📖 First post: ${post.content.substring(0, 50)}...</p>`;
                }
                
                output.innerHTML += '<p>✅ Test completed successfully!</p>';
                
            } catch (error) {
                output.innerHTML += `<p>❌ Error: ${error.message}</p>`;
                console.error('Test error:', error);
            }
        }
        
        // Run test when page loads
        window.onload = testContract;
    </script>
</body>
</html>
